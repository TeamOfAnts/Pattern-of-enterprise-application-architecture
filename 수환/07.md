# 07장 분산 전략

- 객체를 분산하는 작업에는 많은 함정이 도사리고 있음

## 분산 객체의 매력

- 투명성
  - 호출하려는 대상이 동일한 프로세스나 다른 프로세스 또는 다른 시스템에 있느냐와 관계없이 객체가 다른 객체를 한 프로세스 안이나 프로세스 간에 호출할 수 있게 해주는 개념
  - 가치가 높지만 일반적으로 성능에는 긍정적인 영향을 주지는 않음

## 원격 및 로컬 인터페이스

- 프로세스 간의 프로시저 호출은 한 프로세스 내의 호출보다 수십 배 혹은 수백 배 느림
- 로컬 인터페이스는 가는 입자 페이스 일 때 가장 좋음
  - 원격 환경에는 잘 맞지 않음
    - 굵은 입자 인터페이스가 필요
- 분산 시 원격 호출이 많아지고 수정이 불편하므로 "객체를 분산하지 말라"가 객체 설계의 첫 번째 규칙
  - 일반적으론 다중 프로세서는 클러스터링이 적합
    - 모든 클래스를 단일 프로세스에 넣고 해당 프로세스의 여러 복사본을 다수의 노드에서 실행
    - 빠른 속도로 실행 가능

## 분산이 필요한 상황

- 분산 경계 최소화 & 클러스터링도 한계가 있음
- 클라이언트와 서버 간의 분리는 필요하고 정통적인 분리
- 서버 애플리케이션 소프트웨어와 DB 간의 분리
  - 필수적인 것은 아니지만 분리하지 않는 것은 실용적이지 않은 경우가 많으므로 분리
  - SQL이 원격 인터페이스로 설계됐으므로 원격 호출 비용 최소화 가능
- 웹 서버와 애플리케이션 서버 간의 분리
  - 조건이 허락한다면 단일 프로세스가 좋지만 항상 가능한 것은 아님
- 공급업체 간의 차이 때문에 분리해야 할 수도 있음
  - 좋은 패키지는 적어도 굵은 입자 인터페이스를 가짐
- 합당한 이유가 있을 때도 분리
- 분산은 도무지 방법이 없을 때 사용하는 최후의 수단

## 분산 경계를 사용한 작업

- 모든 원격 호출은 추가 비용을 지불하고 실행
- 원격 파사드
  - 내부적으로는 가는 입자를 사용하고 원격 인터페이스를 제공하는 굵은 입자 객체를 분산 경계에 배치
  - 파사드를 아는 사람에게만 허용하도록 함으로써 정책을 명시적으로 만들 수 있음
  - 데이터 객체와 밀접하게 연관
- 브로커를 통해 객체를 프로세스 간에 마이그레이션 해 분산을 구현하는 방법도 있음
  - 지연 로드 체계를 사용
  - 일부 O/R 매핑 툴에서 지원

## 분산을 위한 인터페이스

- 분산 컴포넌트의 인터페이스는 전통적으로 원격 프로시저 호출에 기반을 두는 경우가 많지만 XML over HTTP에 기반을 두는 인터페이스도 나타남 (SOAP)
  - 많은 양의 데이터를 구조화된 형식을 통해 단 한 번의 왕복으로 손쉽게 전송 가능
  - 다양한 플랫폼에서 이 기반으로 시스템 구축 가능
  - HTTP는 방화벽 통과도 쉬움
- 두 시스템이 동일한 플랫폼으로 구축된 경우라면 해당 플랫폼의 기본 제공 원격 호출 메카니즘 사용
- 원격 객체지향 API로 보안과 트랜잭션 처리가 필요하면 객체지향 인터페이스 위에 HTTP 인터페이스 계층 추가
